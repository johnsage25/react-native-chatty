{"version":3,"sources":["ChatBubble.tsx"],"names":["ParsedText","_ChatBubble","props","message","children","propsContext","PropsContext","mediaLoaded","setMediaLoaded","showMedia","setShowMedia","showUrlPreview","setShowUrlPreview","urlPreviewData","setUrlPreviewData","createdAt","format","avatarSize","width","bubbleProps","showAvatars","height","borderRadius","bubbleBackgroundColor","containerStyle","me","backgroundColor","selfBubbleColor","otherBubbleColor","bubbleAlignment","alignSelf","media","forEach","type","MediaType","Image","InteractionManager","runAfterInteractions","prefetch","uri","then","enableUrlPreviews","url","text","data","onPressPattern","pattern","index","ChatEmitter","emit","messagePatterns","patterns","enablePatterns","patternProps","customPatterns","push","allowPatterns","HASHTAG_PATTERN_SHAPE","MENTION_PATTERN_SHAPE","URL_PATTERN_SHAPE","ALL_PATERNS_SHAPES","renderTicks","status","MessageStatus","Sending","tickProps","sendingElement","Sent","sentElement","Delivered","deliveredElement","Read","readElement","renderFooter","styles","bubbleFooter","date","dateStyle","renderCornerRounding","enableCornerRounding","rightArrow","rightArrowOverlap","listProps","leftArrow","leftArrowOverlap","renderMedia","flexDirection","flexWrap","map","length","backgroundOverlay","color","textAlign","fontSize","PhotoView","renderUrlPreview","repliedTo","marginTop","title","description","image","wrapper","trailingAccessory","visible","user","avatar","require","container","padding","username","id","labelStyle","avatarMe","ChatBubble","React","memo","StyleSheet","create","alignItems","justifyContent","margin","maxWidth","Dimensions","get","position","bottom","borderBottomLeftRadius","right","borderBottomRightRadius","left","marginLeft","marginRight","moreMedia","borderWidth","borderStyle","borderColor","marginBottom","alignContent"],"mappings":"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","sourcesContent":["import dayjs from 'dayjs';\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport {\n  Dimensions,\n  Image,\n  ImageBackground,\n  InteractionManager,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n  ViewStyle,\n} from 'react-native';\nimport { PropsContext } from './Chatty';\nimport { ReplyingTo } from './components/ReplyingTo';\nimport { UrlPreviewBubble } from './components/UrlPreviewBubble';\nimport {\n  IChatBubble,\n  IMessage,\n  IUrlPreviewBubble,\n  MediaType,\n  MessageStatus,\n} from './types/Chatty.types';\nimport { ChatEmitter } from './utils/eventEmitter';\nimport { extractUrlFromString, fetchMetaData } from './utils/helpers';\nimport { Skeleton } from './utils/moti';\nimport {\n  ALL_PATERNS_SHAPES,\n  HASHTAG_PATTERN_SHAPE,\n  LoadAllPaternShapes,\n  loadParsedText,\n  MENTION_PATTERN_SHAPE,\n  URL_PATTERN_SHAPE,\n} from './utils/patterns';\nimport { PhotoView } from './utils/photoView';\nimport { ContextMenuWrapper } from './wrappers/ContextMenuWrapper';\n\nconst ParsedText = loadParsedText();\n\nfunction _ChatBubble(props: IChatBubble) {\n  const { message, children } = props;\n  const propsContext = useContext(PropsContext);\n  const [mediaLoaded, setMediaLoaded] = useState<boolean>(false);\n  const [showMedia, setShowMedia] = useState<boolean>(false);\n  const [showUrlPreview, setShowUrlPreview] = useState(false);\n  const [urlPreviewData, setUrlPreviewData] = useState<IUrlPreviewBubble>();\n  const createdAt = useMemo(() => {\n    return message && dayjs(message.createdAt).format('HH:mm');\n  }, [message]);\n\n  const avatarSize = useMemo(() => {\n    return {\n      width: propsContext.bubbleProps?.showAvatars?.width || 40,\n      height: propsContext.bubbleProps?.showAvatars?.width || 40,\n      borderRadius: propsContext.bubbleProps?.showAvatars?.width || 40,\n    };\n  }, [propsContext.bubbleProps?.showAvatars?.width]);\n\n  const bubbleBackgroundColor = useMemo<ViewStyle>(() => {\n    if (propsContext.bubbleProps?.containerStyle) {\n      if (message?.me) {\n        return {\n          backgroundColor:\n            propsContext?.bubbleProps?.selfBubbleColor ?? '#afddfa',\n          ...propsContext.bubbleProps.containerStyle,\n        };\n      } else {\n        return {\n          backgroundColor:\n            propsContext?.bubbleProps?.otherBubbleColor ?? '#c8faaf',\n\n          ...propsContext.bubbleProps.containerStyle,\n        };\n      }\n    }\n\n    if (message?.me) {\n      return {\n        backgroundColor:\n          propsContext?.bubbleProps?.selfBubbleColor ?? '#afddfa',\n      };\n    }\n\n    return {\n      backgroundColor: propsContext?.bubbleProps?.otherBubbleColor ?? '#c8faaf',\n    };\n  }, [\n    message?.me,\n    propsContext?.bubbleProps?.otherBubbleColor,\n    propsContext?.bubbleProps?.selfBubbleColor,\n    propsContext.bubbleProps?.containerStyle,\n  ]);\n\n  const bubbleAlignment = useMemo<ViewStyle>(() => {\n    if (message?.me) {\n      return {\n        alignSelf: 'flex-end',\n      };\n    }\n\n    return {\n      alignSelf: 'flex-start',\n    };\n  }, [message?.me]);\n\n  useEffect(() => {\n    if (message?.media) {\n      message.media.forEach((media) => {\n        if (media.type === MediaType.Image) {\n          InteractionManager.runAfterInteractions(() => {\n            Image.prefetch(media.uri).then(() => {\n              setMediaLoaded(true);\n            });\n          });\n        }\n      });\n    }\n\n    if (propsContext.enableUrlPreviews) {\n      InteractionManager.runAfterInteractions(async () => {\n        const url = extractUrlFromString(message?.text ?? '');\n\n        if (url) {\n          const data = await fetchMetaData(url);\n\n          if (data) {\n            setShowUrlPreview(true);\n            setUrlPreviewData(data);\n          }\n        }\n      });\n    }\n  }, [message?.media, message?.text, propsContext.enableUrlPreviews]);\n\n  const onPressPattern = useCallback(\n    (pattern: string, index: number) => {\n      if (!message) return;\n      ChatEmitter?.emit('patternPressed', pattern, index, message);\n    },\n    [message]\n  );\n\n  const messagePatterns = useMemo(() => {\n    const patterns: any[] = [];\n\n    if (!propsContext?.enablePatterns) return;\n    if (!ParsedText) return;\n\n    LoadAllPaternShapes(onPressPattern);\n\n    if (propsContext.patternProps?.customPatterns) {\n      patterns.push(...propsContext.patternProps.customPatterns);\n    }\n\n    if (propsContext?.patternProps?.allowPatterns) {\n      propsContext.patternProps.allowPatterns.forEach((pattern) => {\n        switch (pattern) {\n          case 'hashtag':\n            patterns.push(HASHTAG_PATTERN_SHAPE);\n            break;\n          case 'mention':\n            patterns.push(MENTION_PATTERN_SHAPE);\n            break;\n          case 'url':\n            patterns.push(URL_PATTERN_SHAPE);\n            break;\n        }\n      });\n    } else {\n      ALL_PATERNS_SHAPES.forEach((pattern) => patterns.push(pattern));\n    }\n\n    return patterns;\n  }, [\n    onPressPattern,\n    propsContext?.enablePatterns,\n    propsContext?.patternProps?.allowPatterns,\n    propsContext?.patternProps?.customPatterns,\n  ]);\n\n  const renderTicks = useCallback(() => {\n    if (message?.status) {\n      switch (message.status) {\n        case MessageStatus.Sending:\n          return (\n            propsContext.bubbleProps?.tickProps?.sendingElement ?? (\n              <Text>ðŸ”„</Text>\n            )\n          );\n\n        case MessageStatus.Sent:\n          return (\n            propsContext.bubbleProps?.tickProps?.sentElement ?? <Text>âœ”</Text>\n          );\n\n        case MessageStatus.Delivered:\n          return (\n            propsContext.bubbleProps?.tickProps?.deliveredElement ?? (\n              <Text>â˜‘</Text>\n            )\n          );\n\n        case MessageStatus.Read:\n          return (\n            propsContext.bubbleProps?.tickProps?.readElement ?? <Text>âœ…</Text>\n          );\n      }\n    }\n\n    return null;\n  }, [\n    message?.status,\n    propsContext.bubbleProps?.tickProps?.deliveredElement,\n    propsContext.bubbleProps?.tickProps?.readElement,\n    propsContext.bubbleProps?.tickProps?.sendingElement,\n    propsContext.bubbleProps?.tickProps?.sentElement,\n  ]);\n\n  const renderFooter = useCallback(() => {\n    return (\n      <View style={styles.bubbleFooter}>\n        <Text\n          style={[\n            styles.date,\n            propsContext?.bubbleProps?.dateStyle &&\n              propsContext?.bubbleProps?.dateStyle!(message?.me ?? false),\n          ]}\n        >\n          {createdAt}\n        </Text>\n        {renderTicks()}\n      </View>\n    );\n  }, [\n    createdAt,\n    message?.me,\n    propsContext?.bubbleProps?.dateStyle,\n    renderTicks,\n  ]);\n\n  const renderCornerRounding = useCallback(() => {\n    if (propsContext.bubbleProps?.enableCornerRounding === false) return null;\n\n    if (message?.me) {\n      return (\n        <>\n          <View style={[styles.rightArrow, bubbleBackgroundColor]}></View>\n          <View\n            style={[\n              styles.rightArrowOverlap,\n              {\n                backgroundColor:\n                  propsContext.listProps?.containerStyle?.backgroundColor ??\n                  '#fff',\n              },\n            ]}\n          ></View>\n        </>\n      );\n    } else {\n      return (\n        <>\n          <View style={[styles.leftArrow, bubbleBackgroundColor]}></View>\n          <View\n            style={[\n              styles.leftArrowOverlap,\n              {\n                backgroundColor:\n                  propsContext.listProps?.containerStyle?.backgroundColor ??\n                  '#fff',\n              },\n            ]}\n          ></View>\n        </>\n      );\n    }\n  }, [\n    bubbleBackgroundColor,\n    message?.me,\n    propsContext.bubbleProps?.enableCornerRounding,\n    propsContext.listProps?.containerStyle?.backgroundColor,\n  ]);\n\n  const renderMedia = useCallback(() => {\n    if (message?.media) {\n      return (\n        <View style={{ flexDirection: 'row', flexWrap: 'wrap' }}>\n          {message?.media.map((media, index) => {\n            if (index < 3) {\n              return (\n                <TouchableOpacity onPress={() => setShowMedia(true)}>\n                  {media.type === MediaType.Image && (\n                    <Skeleton show={!mediaLoaded}>\n                      <Image source={{ uri: media.uri }} style={styles.media} />\n                    </Skeleton>\n                  )}\n                </TouchableOpacity>\n              );\n            }\n\n            return null;\n          })}\n\n          {message.media.length > 3 && (\n            <TouchableOpacity onPress={() => setShowMedia(true)}>\n              <ImageBackground\n                style={styles.media}\n                source={{ uri: message.media[3]?.uri }}\n                imageStyle={{\n                  borderRadius: 15,\n                }}\n              >\n                <View style={styles.backgroundOverlay}>\n                  <Text\n                    style={{ color: '#fff', textAlign: 'center', fontSize: 20 }}\n                  >\n                    + {message.media.length - 3}\n                  </Text>\n                </View>\n              </ImageBackground>\n            </TouchableOpacity>\n          )}\n\n          {PhotoView && (\n            <PhotoView\n              images={message?.media}\n              imageIndex={0}\n              visible={showMedia}\n              onRequestClose={() => setShowMedia(false)}\n            />\n          )}\n        </View>\n      );\n    }\n\n    return null;\n  }, [mediaLoaded, message, showMedia]);\n\n  const renderUrlPreview = useMemo(() => {\n    if (showUrlPreview && urlPreviewData && !message?.repliedTo) {\n      return (\n        <View style={{ marginTop: 10 }}>\n          <UrlPreviewBubble\n            title={urlPreviewData.title}\n            description={urlPreviewData.description}\n            image={urlPreviewData.image}\n            url={urlPreviewData.url}\n          />\n        </View>\n      );\n    }\n\n    return null;\n  }, [message?.repliedTo, showUrlPreview, urlPreviewData]);\n\n  return (\n    <View style={[styles.wrapper, bubbleAlignment]}>\n      {propsContext.bubbleProps?.trailingAccessory && message?.me && (\n        <View>{propsContext.bubbleProps.trailingAccessory}</View>\n      )}\n\n      {propsContext.bubbleProps?.showAvatars?.visible && !message?.me && (\n        <Image\n          source={\n            message?.user.avatar ?? require('./assets/images/noavatar.png')\n          }\n          style={[styles.avatar, avatarSize]}\n        />\n      )}\n\n      <ContextMenuWrapper message={message as IMessage}>\n        <View\n          style={[\n            bubbleBackgroundColor,\n            styles.container,\n            propsContext.bubbleProps?.containerStyle,\n            { padding: message?.repliedTo ? 5 : 15 },\n          ]}\n        >\n          {children ? (\n            children\n          ) : (\n            <>\n              {message?.repliedTo && (\n                <ReplyingTo\n                  username={message?.repliedTo?.user.username}\n                  text={message?.repliedTo.text}\n                  messageId={message?.repliedTo.id}\n                />\n              )}\n\n              {propsContext?.enablePatterns && ParsedText ? (\n                <>\n                  {renderMedia()}\n\n                  <ParsedText\n                    parse={messagePatterns}\n                    style={\n                      propsContext?.bubbleProps?.labelStyle &&\n                      propsContext.bubbleProps?.labelStyle(message?.me ?? false)\n                    }\n                  >\n                    {message?.text}\n                  </ParsedText>\n                  {renderUrlPreview}\n                  {renderFooter()}\n                </>\n              ) : (\n                <View>\n                  {renderMedia()}\n\n                  <Text\n                    style={\n                      propsContext?.bubbleProps?.labelStyle &&\n                      propsContext.bubbleProps?.labelStyle(message?.me ?? false)\n                    }\n                  >\n                    {message?.text}\n                  </Text>\n                  {renderUrlPreview}\n                  {renderFooter()}\n                </View>\n              )}\n            </>\n          )}\n          {renderCornerRounding()}\n        </View>\n      </ContextMenuWrapper>\n\n      {propsContext.bubbleProps?.showAvatars?.visible && message?.me && (\n        <Image\n          source={\n            message?.user.avatar ?? require('./assets/images/noavatar.png')\n          }\n          style={[styles.avatarMe, avatarSize]}\n        />\n      )}\n\n      {propsContext.bubbleProps?.trailingAccessory && !message?.me && (\n        <View>{propsContext.bubbleProps.trailingAccessory}</View>\n      )}\n    </View>\n  );\n}\n\nexport const ChatBubble = React.memo(_ChatBubble);\n\nexport const styles = StyleSheet.create({\n  wrapper: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n  },\n  container: {\n    margin: 20,\n    maxWidth: Dimensions.get('screen').width - 120,\n    borderRadius: 10,\n  },\n  rightArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomLeftRadius: 25,\n    right: -7,\n  },\n  rightArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomLeftRadius: 18,\n    right: -20,\n  },\n  leftArrow: {\n    position: 'absolute',\n    width: 20,\n    height: 25,\n    bottom: 0,\n    borderBottomRightRadius: 25,\n    left: -10,\n  },\n\n  leftArrowOverlap: {\n    position: 'absolute',\n    width: 20,\n    height: 35,\n    bottom: -6,\n    borderBottomRightRadius: 18,\n    left: -20,\n  },\n  date: {\n    color: '#a8a8a8',\n    fontSize: 11,\n  },\n  avatar: {\n    marginLeft: 10,\n  },\n  avatarMe: {\n    marginRight: 10,\n  },\n  bubbleFooter: {\n    justifyContent: 'flex-end',\n    flexDirection: 'row',\n    marginTop: 5,\n  },\n  moreMedia: {\n    width: 100,\n    height: 100,\n    borderWidth: 1,\n    borderStyle: 'dashed',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderColor: '#ccc',\n  },\n  media: {\n    width: 110,\n    height: 100,\n    borderRadius: 15,\n    marginRight: 10,\n    marginBottom: 10,\n  },\n  backgroundOverlay: {\n    width: 110,\n    height: 100,\n    backgroundColor: 'rgba(0,0,0,0.6)',\n    borderRadius: 15,\n    justifyContent: 'center',\n    alignContent: 'center',\n    alignItems: 'center',\n  },\n});\n"]}